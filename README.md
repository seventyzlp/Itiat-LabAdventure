# 实验室日记UE5开发日志

Developed with Unreal Engine 5
***

### 2022.7.12
1. 完成对话框的触发和剧本导入到窗体蓝图文件
   1. 通过设置actor碰撞事件来触发创建窗体事件，生成对话框
   2. 把创建完的对象添加到视口
   3. 设置actor结束碰撞事件来删除父类对象，设置父类为资源库中的窗体对象
   4. 创建结构体，存储表格标题行，并且设置存储数据类型
   5. 建立数据表格，在建立是选取结构体的行结构，根据结构体存储数据信息，方便导入到窗体控件中
   6. 把剧本输入到数据表格中，并且修改行命名为数字，用于跳转下一行输出
   7. 打开控件蓝图，需要先放置画板后才能自由操纵文本框什么的大小、位置
   8. 如果文本框需要换行，那么需要选择多行文本框，根据表格需求绘制
   9. 选中文本框，选择添加绑定，或者说是直接绑定对应的文本，需要自定义事件进行传递
   10. 传递文本的自定义事件需要在视口蓝图图标界面，事件图表下创建自定义事件，并且为自定义事件添加输入值，并且提升为变量
   11. 选中文本框也可以创建绑定，其实跟直接调用变量没什么区别
   12. 在被交互对象设置接受输入，进行交互按E增加行数来改变显示窗体的内容
2. 进行AI行为树的构建，并且通过行为树的实例创建boss对象
   1. 新建行为树以及黑板，将行为树与黑板进行绑定
   2. 黑板是蓝图与行为树之间的变量传递装置，外界的变量需要通过设置到黑板才能进入行为树中
   3. 行为树中，需要自定义事件
   4. 自定义事件的开始，需要在事件图表进行重载，一般使用“事件接受执行AI”作为开始，“完成执行”结束
   5. 需要新建AIcontroller来控制boss，事件开始运行，执行“运行行为树”执行AI行为树的命令
   6. PawnSensing组件设置后开放事件“看见pawn”
   7. 被控制的bossPawn需要设置pawn属性中的AI控制类为之前创建的AIcontroller
3. 虚幻5内置的世界分区设置会导致部分在另一个分区的实例在编辑时不会被加载出来
   1. 项目标签窗口上会显示出XXX（已卸载）
   2. 通过打开项目设置，在世界分区中关闭世界分区渲染即可解决
### 2022.7.13
1. 实现boss追踪以及发射子弹
   1. 子弹的碰撞需要修改成不阻挡，不然会导致子弹生成后推动boss或者推动玩家
   2. 在设置发射子弹的spawntransform时，通过获取boss的actor位置和旋转然后生成变换
2. 实现血条，并且能够动态追踪血量
   1. 创建用户控件，并且按照之前的方法放置一些图片文本框什么的，并且关键控件是进度条
   2. 通过对进度条进行绑定，设定类为玩家类，并且获取pawn，拿到玩家血量以及玩家的血量上限
   3. 通过做除法的方式获取百分比，导出传递的内容，在做除法时要先将结果端点设置为浮点型，不然会损失数据
### 2022.7.15
好像是昨天搞的太晚忘记写了
1. 实现了boss随机移动，那个在可导航半径范围内寻找点
   1. 导航半径得大点，100多才能看出效果
   2. 并且需要在地图上提前设置好nav什么一个体积，按P会显示出可导航的范围，并且不像虚幻4那样可导航的范围不是绿色的而是灰色的
2. 使用“造成伤害”控件重构了子弹的效果，使得子弹并不只对一个目标有着攻击效果
   1. “造成伤害”与“应用伤害”成对出现，实现对造成伤害的目标进行一个转换吧，就是读取碰撞到的对象
3. 在解决中：小怪向boss移动，目前已经解决boss面向的问题，需要解决的就是boss如何向前移动
### 2022.7.16
1. 修改奇骏boss发射子弹以及主角发射出的子弹
2. 实现boss向玩家移动，本质上其实是移动到玩家一秒之前所在的位置
3. 修改战斗动画
### 2022.7.17
1. 独立出远程小怪和boss的行为树以及重写部分
   1. 因为新多出了一个可攻击目标，所以在主角子弹的攻击目标部分会导致目标不对打不出伤害
   2. 需要在之前类型转换的“cast failed”之后继续尝试转换为另一个攻击目标
2. 修改小怪子弹发射位置
   1. 小怪的子弹是在默认正方向发射的，需要改成从手部发射
   2. 因为正方向不能被修改(?)所以通过旋转小怪的spite实现
   3. 还未解决：**小怪的旋转问题，不能让小怪转一整圈来瞄准主角，应该考虑最短旋转角度**
3. 设置男主以及小怪阵亡画面以及男主的阵亡后传送并且不满血量
   1. 通过“设置图像序列帧视图“改变主角的spite
   2. 还未解决：**spite大小变化过大**
### 2022.7.18
1. 修改spite大小，实现动画效果的统一
   1. spite大小在游戏内是改不了的，需要调整美术素材
   2. 在有两个东西分离的情况下，使用自动提取spite功能很容易会分开提取内容，需要手动设置格子的大小
2. 实现角色死亡后播放动画并且传送回出生点
   1. 使用”禁用/启用输入“来实现角色去世之后无法控制的情况
   2. 并且需要delay一次去世动画播放的时间
3. 实现小怪去世动画
   有两种方法，目前的实现方法是第一种
   1. 因为在角色蓝图内没有禁用AI控制器输入的情况，在设置序列帧动画之后，需要在行为树内进行wait操作
   2. 在行为树内设置受击检测，并且在攻击的seaquence那边添加黑板键检测，并且单独做一个受击倒地的动画行为放到里面
